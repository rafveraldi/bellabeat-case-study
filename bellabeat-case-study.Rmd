---
title: "Bellabeat - Case Study"
subtitle: "Google Data Analytics Capstone"
author: "Rafael Veraldi"
date: "`r format(Sys.time(), '%B %Y')`"
output: html_document
---
<p align="center">
![](./img/bellabeat-logo.png){width=10%}
</p>

## Business Task

**Analyze non-Bellabeat smart device usage data in order to identify trends that will inform the company's marketing strategy.**

Key Stakeholders:

* **Urška Sršen:** Bellabeat’s cofounder and Chief Creative Officer.
* **Sando Mur:** Mathematician and Bellabeat’s cofounder; Member of the executive team.
* **Bellabeat marketing analytics team**

The following questions will guide this analysis:

1. What are some trends in smart device usage?
2. How could these trends apply to Bellabeat customers?
3. How could these trends help influence Bellabeat marketing strategy?

## Data Source

As per Sršen's recommendation, a [FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit) will be used in this analysis. The data set is CC0 public domain made available through [Mobius](https://www.kaggle.com/arashnic) via [Kaggle](https://www.kaggle.com/), it contains personal fitness tracker from thirty fitbit users who consented to the submission of personal tracker data. It includes minute-level output for physical activity, heart rate, and sleep monitoring as well as information about daily activity, steps, and heart rate that will be used to explore users’ habits.

#### Data Assessment for credibility, reliability and integrity

The data set was downloaded and stored locally, it consists of 18 csv files in wide format. ROCCC data test model was used to determine credibility, reliability and integrity as follow:

* **Reliability:** The sample size (30 users) is too small to represent the full population of fitbit users. Therefore any statistical analysis, identification of trends and patterns have low reliability.

* **Originality:** Data is sourced from a survey by Amazon Mechanical Turk. As a third-party survey, this can be classified as low originality.

* **Comprehensiveness:** Data is within the parameters required for the Bellabeat’s business task.However, due to small sample sizing, unavailability of demographic data and incomplete data, the dataset has a low comprehensiveness.

* **Current:** Data was collected in 2016 and could not reflect the current population. Rated as not current.

* **Cited:** Data from survey was generated by Amazon Mechanical Turk, company within the Amazon group.

Overall, due to low credibility, reliability and integrity of this dataset, the following analysis can only be used as a first glimpse and direction. Any decision made from it should be verified by a larger analysis from a more reliable dataset.

## Data Manipulation

Loading packages
```{r Loading packages, message=FALSE}
library(tidyverse)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyr)
library(janitor)
library(skimr)
library(gridExtra)
```

Loading the data set
```{r Loading the data set, message=FALSE}
dailyActivity <- read_csv('./Fitabase Data 4.12.16-5.12.16/dailyActivity_merged.csv')
dailyCalories <- read_csv('./Fitabase Data 4.12.16-5.12.16/dailyCalories_merged.csv')
dailyIntensities <- read_csv('./Fitabase Data 4.12.16-5.12.16/dailyIntensities_merged.csv')
dailySteps <- read_csv('./Fitabase Data 4.12.16-5.12.16/dailySteps_merged.csv')
heartrate_seconds <- read_csv('./Fitabase Data 4.12.16-5.12.16/heartrate_seconds_merged.csv')
hourlyCalories <- read_csv('./Fitabase Data 4.12.16-5.12.16/hourlyCalories_merged.csv')
hourlyIntensities <- read_csv('./Fitabase Data 4.12.16-5.12.16/hourlyIntensities_merged.csv')
hourlySteps <- read_csv('./Fitabase Data 4.12.16-5.12.16/hourlySteps_merged.csv')
minuteCaloriesNarrow <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteCaloriesNarrow_merged.csv')
minuteCaloriesWide <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteCaloriesWide_merged.csv')
minuteIntensitiesNarrow <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteIntensitiesNarrow_merged.csv')
minuteIntensitiesWide <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteIntensitiesWide_merged.csv')
minuteMETsNarrow <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteMETsNarrow_merged.csv')
minuteSleep <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteSleep_merged.csv')
minuteStepsNarrow <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteStepsNarrow_merged.csv')
minuteStepsWide <- read_csv('./Fitabase Data 4.12.16-5.12.16/minuteStepsWide_merged.csv')
sleepDay <- read_csv('./Fitabase Data 4.12.16-5.12.16/sleepDay_merged.csv')
weightLogInfo <- read_csv('./Fitabase Data 4.12.16-5.12.16/weightLogInfo_merged.csv')
```

Verifying if the loading activity was successful by using head function
```{r using head}
head(dailyActivity)
```
As can be seen, dailyActivity file contains information from many other files and it'll be the main file to be use in this analysis. The sleepDay data is not included in the dailyActivity file and it will be merged as follows.
```{r merging data}
# Date formatting for both files
dailyActivity$ActivityDate <- mdy(dailyActivity$ActivityDate)
sleepDay$SleepDay <- mdy_hms(sleepDay$SleepDay)

# Renaming headers to match when merging
sleepDay <- rename(sleepDay, ActivityDate = SleepDay)

# Merging data
dailyActivity <- merge(dailyActivity,sleepDay, by=c('Id','ActivityDate'))

# Adding weekday column
dailyActivity <- mutate(dailyActivity, Weekday = weekdays(ActivityDate))

# Adding a column for total awake time in bed
dailyActivity <- mutate(dailyActivity, TotalAwakeTimeInBed = TotalTimeInBed - TotalMinutesAsleep)

# Confirming columns were successfully merged by using glimpse function
glimpse(dailyActivity)
```
The data set has been successfully manipulated for my analysis.

## Analysis

By summarizing a selection of columns in the dailyActivity table we can get some first thoughts.
```{r summarizing dailyActivity}
dailyActivity %>%
  select(TotalSteps, Calories, VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes, SedentaryMinutes, TotalMinutesAsleep, TotalAwakeTimeInBed)%>%
  summary()

```
Some points taken from this summary to lead the analysis:

* Daily average of 8,541 steps which is below the 10,000 steps recommended.
* Average of very active minutes is 2.77 times greater than the Median, the distribution is skewed left, meaning the very active minutes are concentrated either in some users or some weekdays.
* Average of 419 minutes of sleep or approximately 7 hours, less than the recommended 8 hours but still acceptable.
* 712 sedentary daily minutes in average or approximately 12 hours, a surprising number for fitness tracker users.
* Users spent in average 39 minutes awake in bed.

```{r Calories and Steps Plot, message=FALSE}
ggplot(data = dailyActivity, mapping = aes(x = TotalSteps, y = Calories)) + geom_jitter() + geom_smooth(method = lm) + theme_bw() + labs(title = "Relation between Daily Calories and Daily Steps", x = "Total Steps") +theme(plot.title = element_text(hjust = 0.5))
```

By plotting the relation between Daily Calories and Daily Steps when each point is an entry from a user, it is clear that there is a positive correlation between both variables, meaning the more active you are, more calories are spent.
```{r Calories by level of activity - Grid, message=FALSE}
plot1 <- ggplot(data = dailyActivity, mapping = aes(x = VeryActiveMinutes, y = Calories)) + geom_jitter() + geom_smooth(method = lm) + theme_bw() + labs(x = "Very Active Minutes", y = "")
plot2 <- ggplot(data = dailyActivity, mapping = aes(x = FairlyActiveMinutes, y = Calories)) + geom_jitter() + geom_smooth(method = lm) + theme_bw() + labs(x = "Faily Active Minutes", y = "")
plot3 <- ggplot(data = dailyActivity, mapping = aes(x = LightlyActiveMinutes, y = Calories)) + geom_jitter() + geom_smooth(method = lm) + theme_bw() + labs(x = "Lightly Active Minutes", y =  "")
plot4 <- ggplot(data = dailyActivity, mapping = aes(x = SedentaryMinutes, y = Calories)) + geom_jitter() + geom_smooth(method = lm) + theme_bw() + labs(x = "Sedentary Minutes", y = "")
grid.arrange(plot1, plot2, plot3, plot4, ncol=2, top = "Relation between Calories spent and Activity levels in the day")
```

When it comes to the relation between calories spent during the day and the level of activity, having very active minutes in a day may contribute directly to spending more calories, even in smaller amounts. Whereas light activity or sedentary minutes have almost no correlation with calorie expenditure.